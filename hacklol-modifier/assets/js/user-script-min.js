function execUserScript(){var userScriptJstorage=$.jStorage.get("user-script"),date=new Date,date_heure="["+date.getDate()+"/"+(date.getMonth()+1)+"/"+date.getFullYear()+" "+date.getHours()+":"+date.getMinutes()+":"+date.getSeconds()+"]";if(null!==userScriptJstorage)if(/eval|xhr|ajax|$.post|$.get|document.cookie|XMLHttpRequest|XMLHTTP|userScriptFunction|codeMirrorUserScript|execUserScript|new function/i.test(userScriptJstorage)){var elErr=document.createElement("p");elErr.setAttribute("style","color: red;"),elErr.setAttribute("class","err"),elErr.innerHTML='<span class="icon icon_fermer"></span> '+date_heure+" "+i18next.t("user-script.forbidden"),document.getElementById("error-user-script").appendChild(elErr)}else try{eval(userScriptJstorage);var elSuccess=document.createElement("p");elSuccess.setAttribute("style","color: blue;"),elSuccess.setAttribute("class","info"),elSuccess.innerHTML='<span class="icon icon_infos"></span> '+date_heure+" "+i18next.t("user-script.success"),document.getElementById("error-user-script").appendChild(elSuccess)}catch(e){var elErr=document.createElement("p");elErr.setAttribute("style","color: red;"),elErr.setAttribute("class","err"),elErr.innerHTML='<span class="icon icon_fermer"></span> '+date_heure+" "+i18next.t("user-script.error")+"<br /><u>"+i18next.t("user-script.error-code")+"</u> : "+e,document.getElementById("error-user-script").appendChild(elErr)}}function saveUserScript(){codeMirrorUserScript.save();var e=$("#editeur_user_script").val();$.jStorage.set("user-script",e),alert(i18next.t("user-script.saved")),execUserScript()}function deleteUserScript(){confirm(i18next.t("user-script.reset-confirm"))&&($.jStorage.deleteKey("user-script"),alert(i18next.t("user-script.deleted")),codeMirrorUserScript.getDoc().setValue('// exemple de script utilisateur\nalert("Hello world !");'))}$("#save-user-script").click(function(){saveUserScript()}),$("#delete-user-script").click(function(){deleteUserScript()}),$(document).ready(function(){execUserScript(),codeMirrorUserScript=CodeMirror.fromTextArea(document.getElementById("editeur_user_script"),{lineNumbers:!0,mode:"javascript",autoRefresh:!0}),null!==$.jStorage.get("user-script")?codeMirrorUserScript.getDoc().setValue($.jStorage.get("user-script")):codeMirrorUserScript.getDoc().setValue('// exemple de script utilisateur\nalert("Hello world !");')});