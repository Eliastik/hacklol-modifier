$(document).ready(function(){if(window.HTMLCanvasElement){var t,e,o="#000",i=!1,n=!1,a=5,c=$("#canvas"),l=c[0].getContext("2d");l.lineJoin="round",l.lineCap="round",c.mousedown(function(o){i=!0,t=o.pageX-this.offsetLeft,e=o.pageY-this.offsetTop}),$(this).mouseup(function(){i=!1,n=!1}),c.bind("touchstart",function(t){u(t,!0)}),$(this).bind("touchend",function(){f()}),c.bind("touchmove",function(t){s(t,!0,this)}),c.mousemove(function(o){i&&(t=o.pageX-this.offsetLeft-10,e=o.pageY-this.offsetTop-10,r())});function s(o,n,a){if(i){if(n){var c=o.originalEvent;o.preventDefault(),void 0!==a&&(t=c.targetTouches[0].pageX-a.offsetLeft,e=c.targetTouches[0].pageY-a.offsetTop)}else void 0!==a&&(t=o.pageX-a.offsetLeft,e=o.pageY-a.offsetTop);r()}}function f(){i=!1,n=!1}function u(o,n){if(i=!0,n){var a=o.originalEvent;o.preventDefault(),"undefined"!=typeof obj&&(t=a.pageX-obj.offsetLeft,e=a.pageY-obj.offsetTop)}else"undefined"!=typeof obj&&(t=o.pageX-this.offsetLeft,e=o.pageY-this.offsetTop)}function r(){n?(l.lineTo(t,e),l.strokeStyle=o,l.lineWidth=a,l.stroke()):(l.beginPath(),l.moveTo(t,e),n=!0)}function p(){l.clearRect(0,0,c.width(),c.height())}$("#couleurs a").each(function(){$(this).css("background",$(this).attr("data-couleur")),$(this).click(function(){return o=$(this).attr("data-couleur"),$("#couleurs a").removeAttr("class",""),$(this).attr("class","actif"),!1})}),$("#choixCouleur").colpick({layout:"hex",submit:0,color:"ffffff",colorScheme:"dark",onChange:function(t,e,i,n,a){$("#choixCouleur").css("background-color","#"+e),o="#"+e},onShow:function(t,e,i,n,a){o=$("#choixCouleur").css("background-color");var c=$(t),l={top:parseInt(c.css("top"),10),left:parseInt(c.css("left"),10)};l.right=l.left+c.outerWidth(),l.bottom=l.top+c.outerHeight();var s=$(window),f={top:s.scrollTop(),left:s.scrollLeft()};f.right=f.left+s.width(),f.bottom=f.top+s.height(),l.bottom>f.bottom&&(l.top=l.top-c.outerHeight(),c.css("top",l.top+"px")),l.right>f.right&&(l.left=l.left-c.outerWidth(),c.css("left",l.left+"px"))}}),$("#largeurs_pinceau input").change(function(){isNaN($(this).val())||(a=$(this).val(),$("#output").html($(this).val()+" pixels"))}),$("#resetPaint").click(function(){p(),$("#largeur_pinceau").val(5).trigger("change"),a=5,$("#output").html("5 pixels"),o="#000000",$(".actif").removeClass("actif"),$("#color_paint_default").addClass("actif"),$("#choixCouleur").css("background-color","#ffffff")}),$("#savePaint").click(function(){e=(e=document.getElementById("canvas")).toDataURL("image/png");try{var t=document.createElement("a");document.body.appendChild(t),t.style="display: none",t.href=e,t.download="drawing-"+(new Date).toISOString()+".png",t.click(),window.open(e)}catch(t){window.open(e)}var e=null}),$("#colorPaint").click(function(){$("#bulleCouleur").stop().slideToggle("slow"),$("#bulleBrush").hide()}),$("#brushPaint").click(function(){$("#bulleBrush").stop().slideToggle("slow"),$("#bulleCouleur").hide()})}else $("#paint-not-compatible").show(),$("#click-paint").hide(),$("#paint-not-compatible").click(function(){alert(i18next.t("paint.not-compatible"))})});