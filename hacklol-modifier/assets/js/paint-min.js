$(document).ready(function(){if(window.HTMLCanvasElement){var t,o,e="#000",i=!1,n=!1,c=5,a=$("#canvas"),s=a[0].getContext("2d");s.lineJoin="round",s.lineCap="round",a.mousedown(function(e){i=!0,t=e.pageX-this.offsetLeft,o=e.pageY-this.offsetTop}),$(this).mouseup(function(){i=!1,n=!1}),a.bind("touchstart",function(t){u(t,!0)}),$(this).bind("touchend",function(){l()}),a.bind("touchmove",function(t){f(t,!0,this)}),a.mousemove(function(e){i&&(t=e.pageX-this.offsetLeft-10,o=e.pageY-this.offsetTop-10,r())});function f(e,n,c){if(i){if(n){var a=e.originalEvent;e.preventDefault(),void 0!==c&&(t=a.targetTouches[0].pageX-c.offsetLeft,o=a.targetTouches[0].pageY-c.offsetTop)}else void 0!==c&&(t=e.pageX-c.offsetLeft,o=e.pageY-c.offsetTop);r()}}function l(){i=!1,n=!1}function u(e,n){if(i=!0,n){var c=e.originalEvent;e.preventDefault(),"undefined"!=typeof obj&&(t=c.pageX-obj.offsetLeft,o=c.pageY-obj.offsetTop)}else"undefined"!=typeof obj&&(t=e.pageX-this.offsetLeft,o=e.pageY-this.offsetTop)}function r(){n?(s.lineTo(t,o),s.strokeStyle=e,s.lineWidth=c,s.stroke()):(s.beginPath(),s.moveTo(t,o),n=!0)}function h(){s.clearRect(0,0,a.width(),a.height())}$("#couleurs a").each(function(){$(this).css("background",$(this).attr("data-couleur")),$(this).click(function(){return e=$(this).attr("data-couleur"),$("#couleurs a").removeAttr("class",""),$(this).attr("class","actif"),!1})}),$("#choixCouleur").colpick({layout:"hex",submit:0,color:"ffffff",colorScheme:"dark",onChange:function(t,o,i,n,c){$("#choixCouleur").css("background-color","#"+o),e="#"+o},onShow:function(t,o,i,n,c){e=$("#choixCouleur").css("background-color");var a=$(t),s={top:parseInt(a.css("top"),10),left:parseInt(a.css("left"),10)};s.right=s.left+a.outerWidth(),s.bottom=s.top+a.outerHeight();var f=$(window),l={top:f.scrollTop(),left:f.scrollLeft()};l.right=l.left+f.width(),l.bottom=l.top+f.height(),s.bottom>l.bottom&&(s.top=s.top-a.outerHeight(),a.css("top",s.top+"px")),s.right>l.right&&(s.left=s.left-a.outerWidth(),a.css("left",s.left+"px"))}}),$("#largeurs_pinceau input").change(function(){isNaN($(this).val())||(c=$(this).val(),$("#output").html($(this).val()+" pixels"))}),$("#resetPaint").click(function(){h(),$("#largeur_pinceau").val(5).trigger("change"),c=5,$("#output").html("5 pixels"),e="#000000",$(".actif").removeClass("actif"),$("#color_paint_default").addClass("actif"),$("#choixCouleur").css("background-color","#ffffff")}),$("#savePaint").click(function(){var t=document.getElementById("canvas");window.open(t.toDataURL("image/png"))}),$("#colorPaint").click(function(){$("#bulleCouleur").stop().slideToggle("slow"),$("#bulleBrush").hide()}),$("#brushPaint").click(function(){$("#bulleBrush").stop().slideToggle("slow"),$("#bulleCouleur").hide()})}else $("#paint-not-compatible").show(),$("#click-paint").hide(),$("#paint-not-compatible").click(function(){alert(i18next.t("paint.not-compatible"))})});