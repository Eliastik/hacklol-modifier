function execUserScript(){var userScriptJstorage=$.jStorage.get("user-script"),date=new Date,date_heure="["+date.getDate()+"/"+(date.getMonth()+1)+"/"+date.getFullYear()+" "+date.getHours()+":"+date.getMinutes()+":"+date.getSeconds()+"]";if(null!==userScriptJstorage)if(/eval|xhr|ajax|$.post|$.get|document.cookie|XMLHttpRequest|XMLHTTP|userScriptFunction|codeMirrorUserScript|execUserScript|new function/i.test(userScriptJstorage)){var elErr=document.createElement("p");elErr.setAttribute("style","color: red;"),elErr.setAttribute("class","err"),"en"==hacklol.lang?elErr.innerHTML='<span class="icon icon_fermer"></span> '+date_heure+" Some forbidden functions have been detected in your User Script. The execution of your User Script have been canceled.":elErr.innerHTML='<span class="icon icon_fermer"></span> '+date_heure+" Des fonctions dont l'utilisation est bloquée ont été détectées. L'exécution de votre User Script a été annulée.",document.getElementById("error-user-script").appendChild(elErr)}else try{eval(userScriptJstorage);var elSuccess=document.createElement("p");elSuccess.setAttribute("style","color: blue;"),elSuccess.setAttribute("class","info"),"en"==hacklol.lang?elSuccess.innerHTML='<span class="icon icon_infos"></span> '+date_heure+" Your User Script was successfully executed !":elSuccess.innerHTML='<span class="icon icon_infos"></span> '+date_heure+" Votre User Script a été executé avec succès !",document.getElementById("error-user-script").appendChild(elSuccess)}catch(a){var elErr=document.createElement("p");elErr.setAttribute("style","color: red;"),elErr.setAttribute("class","err"),"en"==hacklol.lang?elErr.innerHTML='<span class="icon icon_fermer"></span> '+date_heure+" Error when executing your User Script.<br /><u>Error code</u> : "+a:elErr.innerHTML='<span class="icon icon_fermer"></span> '+date_heure+" Erreur lors de l'exécution de votre User Script.<br /><u>Code d'erreur</u> : "+a,document.getElementById("error-user-script").appendChild(elErr)}}function saveUserScript(){codeMirrorUserScript.save();var a=$("#editeur_user_script").val();$.jStorage.set("user-script",a),"en"==hacklol.lang?alert("Your User Script have been successfully saved !"):alert("Votre User Script a été sauvegardé avec succès !"),execUserScript()}function deleteUserScript(){"en"==hacklol.lang&&confirm("Are you sure that you want to delete your User Script ?")?($.jStorage.deleteKey("user-script"),alert("User Script deleted !"),codeMirrorUserScript.getDoc().setValue('// exemple de script utilisateur\nalert("Hello world !");')):"fr"==hacklol.lang&&confirm("Êtes-vous sûr de vouloir supprimer votre User Script ?")&&($.jStorage.deleteKey("user-script"),alert("User Script supprimé !"),codeMirrorUserScript.getDoc().setValue('// exemple de script utilisateur\nalert("Hello world !");'))}$("#save-user-script").click(function(){saveUserScript()}),$("#delete-user-script").click(function(){deleteUserScript()}),$(document).ready(function(){execUserScript(),codeMirrorUserScript=CodeMirror.fromTextArea(document.getElementById("editeur_user_script"),{lineNumbers:!0,mode:"javascript",autoRefresh:!0}),null!==$.jStorage.get("user-script")?codeMirrorUserScript.getDoc().setValue($.jStorage.get("user-script")):codeMirrorUserScript.getDoc().setValue('// exemple de script utilisateur\nalert("Hello world !");')});
